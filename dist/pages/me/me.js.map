{"version":3,"file":"pages/me/me.js","sources":["webpack:///./src/pages/me/me.jsx","webpack:///./src/pages/me/me.jsx?6cc5","webpack:///./src/pages/me/me.scss"],"sourcesContent":["import React, { Component } from 'react';\nimport Taro from '@tarojs/taro';\nimport {\n  View, Image, Button, Text\n} from '@tarojs/components';\nimport { connect } from 'react-redux';\nimport { AtIcon } from 'taro-ui';\n\nimport { User } from '../../common/api';\nimport { getUser } from '../../actions/user';\nimport WithLogin from '../../components/with/with-login';\n\nimport './me.scss'\n\n@connect(({ user }) => ({\n  user\n}), (dispatch) => ({\n  dispatch,\n}))\nclass Me extends Component {\n\n  componentDidMount() {\n    this.init();\n  }\n\n  init() {\n\n  }\n\n  // 跳到个人主页\n  goHomePage = () => {\n    const { user: { id } } = this.props;\n    Taro.navigateTo({\n      url: '/pages/user-home/user-home?id='+id\n    });\n  }\n\n  // 跳到编辑信息\n  goEdit = () => {\n    Taro.navigateTo({\n      url: '/pages/subPackage/user-edit/user-edit'\n    })\n  }\n\n  // 跳到学生认证页面\n  goSchool = () => {\n    Taro.navigateTo({\n      url: '/pages/user-school/user-school'\n    })\n  }\n\n  // 授权回调函数\n  onGetUserInfo = async  (e) => {\n    const { dispatch } = this.props;\n    const { detail } = e;\n    if (detail['encryptedData']) {\n      const {\n        encryptedData,\n        iv,\n        rawData,\n        signature\n      } = detail;\n      let result = await User.bindInfo(encryptedData, iv, rawData, signature);\n      if (result) {\n        dispatch(getUser());\n      }\n    } else {\n      User.showToast('你已取消授权');\n    }\n  }\n\n  render() {\n    const { user = null } = this.props;\n    return (\n      <View className='container'>\n        {\n          !User.isEmptyObject(user) ? (\n            <View className='info' onClick={this.goHomePage}>\n              <View className='avtater'>\n                <Image src={user.avatar || '../../images/empty_avator.svg'} />\n              </View>\n              <View className='content'>\n                <View className='nick'>{user.user_nickname || '未知'}</View>\n                <View className='des'>\n                  <Text>\n                    <Text className='label'>关注</Text>\n                    <Text className='value'>{user.followNum || 0}</Text>\n                  </Text>\n                  <Text>\n                    <Text className='label'>粉丝</Text>\n                    <Text className='value'>{user.fansNum || 0}</Text>\n                  </Text>\n                </View>\n              </View>\n              <WithLogin onClick={this.goHomePage}>\n                <View className='right'>\n                  <View>个人主页</View>\n                  <AtIcon value='chevron-right' size='14' />\n                </View>\n              </WithLogin>\n            </View>\n          ) : (\n            <Button lang='zh_CN' onGetUserInfo={this.onGetUserInfo} className='info' openType='getUserInfo'>\n              <View className='avtater'>\n                <Image src='../../images/empty_avator.svg' />\n              </View>\n              <View className='content'>\n                <View className='nick'>未登录</View>\n                <View className='des'>登录后可编辑个人资料</View>\n              </View>\n              <View className='right'>\n                <View className='login-txt'>点击微信授权</View>\n              </View>\n            </Button>\n          )\n        }\n        <View className='cells'>\n          <WithLogin onClick={this.goEdit}>\n            <Button className='cell'>\n              <View className='left'>\n                <View className='title'>编辑信息</View>\n                <View className='des'>完善个人信息让更多同学了解你</View>\n              </View>\n              <View className='right'>\n                <AtIcon value='chevron-right' size='14' />\n              </View>\n            </Button>\n          </WithLogin>\n          {\n            !User.isEmptyObject(user) && user.is_auth !== 2 ? (\n              <Button className='cell' onClick={this.goSchool}>\n                <View className='left'>\n                  <View className='title'>学生认证</View>\n                  <View className='des'>学生认证后可解锁更多特权</View>\n                </View>\n                <View className='right'>\n                  <View className='auth'>未认证</View>\n                  <AtIcon value='chevron-right' size='14' />\n                </View>\n              </Button>\n            ) : null\n          }\n        </View>\n        <View className='cells'>\n          <Button className='cell' open-type='contact'>\n            <View className='left'>\n              <View className='title'>帮助与反馈</View>\n              <View className='des'>投稿、帮助、合作都可以点击这里</View>\n            </View>\n            <View className='right'>\n              <AtIcon value='chevron-right' size='14' />\n            </View>\n          </Button>\n          <Button className='cell' open-type='feedback'>\n            <View className='left'>\n              <View className='title'>意见反馈</View>\n              <View className='des'>你的意见和建议，是对我们最大的支持</View>\n            </View>\n            <View className='right'>\n              <AtIcon value='chevron-right' size='14' />\n            </View>\n          </Button>\n          <Button className='cell' open-type='share'>\n            <View className='left'>\n              <View className='title'>分享小程序</View>\n              <View className='des'>觉得有趣，就分享给你身边的同学吧</View>\n            </View>\n            <View className='right'>\n              <AtIcon value='chevron-right' size='14' />\n            </View>\n          </Button>\n        </View>\n      </View>\n    );\n  }\n}\n\nexport default Me;\n","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../node_modules/@tarojs/mini-runner/node_modules/babel-loader/lib/index.js!./me.jsx\"\nvar config = {\"navigationBarTitleText\":\"我的\",\"navigationBarBackgroundColor\":\"#f8f8f8\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/me/me', {}, config || {}))\n\n","// extracted by mini-css-extract-plugin"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAGA;AACA;AAEA;AACA;AACA;AAEA;AAOA;AALA;AAAA;AACA;AADA;AAAA;AAEA;AACA;AADA;AAFA;;;;;;;;;;;;;;;;AAgBA;AAAA;AAEA;AACA;AADA;;;AAMA;AACA;AACA;AADA;;;AAMA;AACA;AACA;AADA;;;;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AACA;AAIA;AALA;AAAA;AACA;AADA;AAUA;AACA;AAAA;AACA;AACA;AACA;AAdA;AAAA;AACA;AADA;AAeA;AACA;AAhBA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;AA/BA;AACA;AACA;;;AAEA;AACA;;;AA6CA;AAAA;AAAA;AAEA;AACA;AAAA;AAGA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AAGA;AAAA;AACA;AAAA;AAIA;AAAA;AACA;AAAA;AAEA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AAKA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AAMA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAMA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AAGA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AAGA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AAMA;;;;AA3JA;AA8JA;;;;;;;;;;;;;ACjLA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACNA;;;;A","sourceRoot":""}