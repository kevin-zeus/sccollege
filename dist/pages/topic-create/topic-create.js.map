{"version":3,"file":"pages/topic-create/topic-create.js","sources":["webpack:///./src/pages/topic-create/topic-create.jsx","webpack:///./src/pages/topic-create/topic-create.jsx?ef84","webpack:///./src/pages/topic-create/topic-create.scss"],"sourcesContent":["import React, { Component } from 'react';\nimport Taro from '@tarojs/taro';\nimport { View, Image, Text, Input } from '@tarojs/components';\nimport { AtIcon, AtButton } from 'taro-ui';\n\nimport './topic-create.scss';\n\nimport { Topic } from '../../common/api';\n\nclass TopicCreate extends Component {\n\n  state = {\n    icon: '',\n    title: '',\n    follow_name: '',\n    des: '',\n    disabled: false,\n  }\n\n  changeIcon = async () => {\n    const path = await Topic.uploadOneImg();\n    this.setState({\n      icon: path\n    });\n  }\n\n  inputChange(type, e) {\n    const { value } = e.detail;\n    console.log(value.length);\n    switch(type) {\n      case 'title': {\n        this.setState({\n          title: value,\n        });\n        break;\n      }\n      case 'follow_name': {\n        this.setState({\n          follow_name: value,\n        });\n        break;\n      }\n      case 'des': {\n        this.setState({\n          des: value,\n        });\n        break;\n      }\n      default: return;\n    }\n  }\n\n  onSubmit = async () => {\n    const { icon, des, title, follow_name } = this.state;\n    let msg = '';\n    if (!icon) msg = '图标不能为空';\n    if (!des) msg = '介绍不能为空';\n    if (!title) msg = '话题名称不能为空';\n    if (!follow_name) msg = '关注者称呼不能为空';\n    if (des.length > 20) msg = '介绍不能超过20个字';\n    if (title.length > 8) msg = '名称不能超过8个字';\n    if (follow_name > 4) msg = '称呼不能超过4个字';\n\n    if (msg) {\n      Topic.showToast(msg);\n      return;\n    }\n    this.setState({\n      disabled: true,\n    })\n    const result = await Topic.add(title, des, icon, follow_name);\n    this.setState({\n      disabled: false,\n    })\n    if (result) {\n      setTimeout(() => {\n        Taro.navigateBack();\n      }, 2000);\n    }\n  }\n\n  render() {\n    const { icon, title, follow_name, des, disabled } = this.state;\n    return (\n      <View>\n        <View className='form-item'>\n          <View className='des'>新建话题提交之后，需要等官方审核通过后才能和大家见面哦</View>\n        </View>\n        <View className='form-item'>\n          <View className='label'>话题图标：</View>\n          <View onClick={this.changeIcon} style={{display: 'inline-block'}}>\n            {\n              icon ? (\n                <Image className='img' src={Topic.parseQiniuImg(icon)} />\n              ) : (\n                <View className='img'>\n                  <AtIcon value='image' color='#ccc' />\n                  <Text className='des'>选择一张图片</Text>\n                </View>\n              )\n            }\n          </View>\n        </View>\n        <View className='form-item'>\n          <View className='label'>话题名称：</View>\n          <View className='des'>好的名称是吸引小伙伴的关键</View>\n          <Input className='form-control' value={title} onInput={(e) => this.inputChange('title', e)} />\n        </View>\n        <View className='form-item'>\n          <View className='label'>一句话介绍：</View>\n          <View className='des'>简短的介绍可以拉近朋友间的距离</View>\n          <Input className='form-control' value={des} onInput={(e) => this.inputChange('des', e)} />\n        </View>\n        <View className='form-item'>\n          <View className='label'>对话题关注者的称呼：</View>\n          <View className='des'>在这里，我们都叫{follow_name}</View>\n          <Input className='form-control' value={follow_name} onInput={(e) => this.inputChange('follow_name', e)} />\n        </View>\n        <View className='form-item'>\n          <AtButton type='primary' disabled={disabled} onClick={this.onSubmit} >提交</AtButton>\n        </View>\n      </View>\n    )\n  }\n}\n\nexport default TopicCreate;\n","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../node_modules/@tarojs/mini-runner/node_modules/babel-loader/lib/index.js!./topic-create.jsx\"\nvar config = {\"navigationBarTitleText\":\"创建话题\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/topic-create/topic-create', {}, config || {}))\n\n","// extracted by mini-css-extract-plugin"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AALA;AACA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AACA;AAAA;AACA;AADA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;;;AAiCA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAVA;AAAA;AAAA;AAAA;AACA;AAWA;AAZA;AACA;AADA;AAeA;AACA;AADA;AACA;AAhBA;AAAA;AACA;AADA;AAkBA;AACA;AAAA;AACA;AADA;AACA;AAEA;AACA;AACA;AADA;AAGA;AACA;AA3BA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;AA1BA;AAAA;AAEA;AACA;AAAA;AACA;AAAA;AACA;AACA;AADA;AAGA;AACA;AACA;AAAA;AAAA;AACA;AACA;AADA;AAGA;AACA;AACA;AAAA;AAAA;AACA;AACA;AADA;AAGA;AACA;AACA;AAAA;AAAA;AAnBA;AAqBA;;;AA+BA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AAAA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAMA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AAAA;AAIA;;;;AAlHA;AACA;AAoHA;;;;;;;;;;;;;AC9HA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACNA;;;;A","sourceRoot":""}