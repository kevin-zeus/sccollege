{"version":3,"file":"pages/subPackage/notice-list/notice-list.js","sources":["webpack:///./src/pages/subPackage/notice-list/notice-list.jsx","webpack:///./src/components/notice-comment/notice-comment.jsx","webpack:///./src/components/notice-comment/notice-comment.scss","webpack:///./src/components/notice-follow/notice-follow.jsx","webpack:///./src/components/notice-follow/notice-follow.scss","webpack:///./src/components/notice-official/notice-official.jsx","webpack:///./src/components/notice-official/notice-official.scss","webpack:///./src/components/notice-reply/notice-reply.jsx","webpack:///./src/components/notice-reply/notice-reply.scss","webpack:///./src/pages/subPackage/notice-list/notice-list.jsx?8f90"],"sourcesContent":["import React, { Component } from 'react';\nimport Taro from '@tarojs/taro';\n\nimport MyPage from '../../../components/my-page/my-page';\nimport NoticeOfficial from '../../../components/notice-official/notice-official';\nimport NoticeFollow from '../../../components/notice-follow/notice-follow';\nimport NoticeComment from '../../../components/notice-comment/notice-comment';\nimport NoticeReply from '../../../components/notice-reply/notice-reply';\n\nimport { Notice } from '../../../common/api';\n\nexport default class NoticeList extends Component {\n\n  state = {\n    type: null,\n    pageState: 0,\n    page: 1,\n    dataList: [],\n    noMore: false,\n    showMoreLoading: false,\n  }\n\n  componentDidMount() {\n    this.init();\n  }\n\n  init = async () => {\n    const { page } = this.state;\n    const { type } = this.$router.params;\n    console.log(type);\n    this.setState({\n      pageState: 0,\n      type,\n    });\n    let dataList = [];\n    switch(type) {\n      case 'official':\n        dataList = await Notice.official(page);\n        Taro.setNavigationBarTitle({\n          title: '官方通知'\n        });\n        break;\n      case 'follow':\n        dataList = await Notice.beFollow(page);\n        Taro.setNavigationBarTitle({\n          title: '新粉丝'\n        });\n        break;\n      case 'comment':\n        dataList = await Notice.beComment(page);\n        Taro.setNavigationBarTitle({\n          title: '被评论'\n        });\n        break;\n      case 'reply':\n        dataList = await Notice.beReply(page);\n        Taro.setNavigationBarTitle({\n          title: '被回复'\n        });\n        break;\n    }\n    if (dataList && dataList.length !== 0) {\n      this.setState({\n        dataList,\n        page: page + 1,\n        pageState: 3\n      });\n    } else {\n      this.setState({\n        pageState: 1,\n      })\n    }\n  }\n\n  onScrollToLower = async () => {\n    const { page, dataList, noMore, type } = this.state;\n    if (noMore) return;\n\n    this.setState(() => ({\n      showMoreLoading: true,\n    }));\n    let newList = [];\n    switch(type) {\n      case 'official':\n        newList = await Notice.official(page);\n        break;\n      case 'follow':\n        newList = await Notice.beFollow(page);\n        break;\n      case 'comment':\n        newList = await Notice.beComment(page);\n        break;\n      case 'reply':\n        newList = await Notice.beReply(page);\n        break;\n    }\n    if (newList && newList.length !== 0) {\n      this.setState({\n        dataList: dataList.concat(newList),\n        page: page + 1,\n      });\n    } else {\n      this.setState({\n        noMore: true,\n      })\n    }\n    this.setState(() => ({\n      showMoreLoading: false,\n    }))\n  }\n\n  render() {\n    const { pageState, showMoreLoading, dataList, type } = this.state;\n    return (\n      <MyPage\n        autoHeight\n        state={pageState}\n        enableTips={false}\n        showMoreLoading={showMoreLoading}\n        onScrollToLower={this.onScrollToLower}\n        onRetry={this.init}\n      >\n        {\n          type === 'official' &&  dataList.map(item => (\n            <NoticeOfficial key={item.id} data={item} />\n          ))\n        }\n        {\n          type === 'follow' &&  dataList.map(item => (\n            <NoticeFollow key={item.id} data={item} />\n          ))\n        }\n        {\n          type === 'comment' && dataList.map(item => (\n            <NoticeComment key={item.id} data={item} />\n          ))\n        }\n        {\n          type === 'reply' && dataList.map(item => (\n            <NoticeReply key={item.id} data={item} />\n          ))\n        }\n      </MyPage>\n    )\n  }\n}\n","import React, { Component } from 'react'\nimport Taro from '@tarojs/taro';\nimport { View } from '@tarojs/components';\nimport { AtAvatar } from 'taro-ui';\n\nimport { Notice } from '../../common/api';\n\nimport './notice-comment.scss'\n\nexport default class NoticeComment extends Component {\n\n  state = {\n    is_read: false,\n  }\n\n  componentDidMount() {\n    this.init();\n  }\n\n  init() {\n    const { data } = this.props;\n    this.setState({\n      is_read: data.is_read,\n    });\n  }\n\n  handleClick = async () => {\n    const { is_read } = this.state;\n    const { data } = this.props;\n    if (!is_read) {\n      const res = await Notice.beComment(null, data.id);\n      if (res) {\n        this.setState({\n          is_read: true,\n        });\n      }\n    }\n\n    Taro.navigateTo({\n      url: '/pages/post/post?id='+data.post_id\n    });\n  }\n\n  goUserHome = () => {\n    const { data } = this.props;\n    Taro.navigateTo({\n      url: '/pages/user-home/user-home?id='+data.from_uid\n    })\n  }\n\n  render() {\n    const { is_read } = this.state;\n    const { data } = this.props;\n    return (\n      <View>\n        {\n          data && (\n            <View\n              className='card'\n              style={{\n                backgroundColor: is_read ? '#e5e5e5' : '#ff494933'\n              }}\n              onClick={this.handleClick}\n            >\n              <View className='header' onClick={this.goUserHome}>\n                <AtAvatar image={data.from_user.avatar} size='small' />\n                <View className='right'>\n                  <View className='nickname'>{data.from_user.user_nickname}</View>\n                  <View className='date'>{data.create_at}</View>\n                </View>\n              </View>\n              <View className='content'>{data.content}</View>\n            </View>\n          )\n        }\n      </View>\n    )\n  }\n}\n","// extracted by mini-css-extract-plugin","import React, { Component } from 'react'\nimport Taro from '@tarojs/taro';\nimport { View, Text } from '@tarojs/components';\n\nimport { Notice } from '../../common/api';\n\nimport './notice-follow.scss'\n\nexport default class NoticeFollow extends Component {\n\n  state = {\n    is_read: false,\n  }\n\n  componentDidMount() {\n    this.init();\n  }\n\n  init() {\n    const { data } = this.props;\n    this.setState({\n      is_read: data.is_read,\n    });\n  }\n\n  handleClick = async () => {\n    const { is_read } = this.state;\n    const { data } = this.props;\n    if (!is_read) {\n      const res = await Notice.beFollow(null, data.id);\n      if (res) {\n        this.setState({\n          is_read: true,\n        });\n      }\n    }\n\n    Taro.navigateTo({\n      url: '/pages/user-home/user-home?id='+data.fans_id\n    });\n  }\n\n  render() {\n    const { is_read } = this.state;\n    const { data } = this.props;\n    return (\n      <View>\n        {\n          data && (\n            <View\n              className='card'\n              style={{\n                backgroundColor: is_read ? '#e5e5e5' : '#ff494933'\n              }}\n              onClick={this.handleClick}\n            >\n              <View className='date'>{data.create_at}</View>\n              <Text>{data.content}</Text>\n            </View>\n          )\n        }\n      </View>\n    )\n  }\n}\n","// extracted by mini-css-extract-plugin","import React, { Component } from 'react'\nimport { View, Text } from '@tarojs/components';\n\nimport { Notice } from '../../common/api';\n\nimport './notice-official.scss'\n\nexport default class NoticeOfficial extends Component {\n\n  state = {\n    is_read: false,\n  }\n\n  componentDidMount() {\n    this.init();\n  }\n\n  init() {\n    const { data } = this.props;\n    this.setState({\n      is_read: data.is_read,\n    });\n  }\n\n  handleClick = async () => {\n    const { is_read } = this.state;\n    if (is_read) return;\n\n    const { data } = this.props;\n    const res = await Notice.official(null, data.id);\n    if (res) {\n      this.setState({\n        is_read: true,\n      });\n    }\n  }\n\n  render() {\n    const { is_read } = this.state;\n    const { data } = this.props;\n    return (\n      <View>\n        {\n          data && (\n            <View\n              className='card'\n              style={{\n                backgroundColor: is_read ? '#e5e5e5' : '#ff494933'\n              }}\n              onClick={this.handleClick}\n            >\n              <View className='date'>{data.create_at}</View>\n              <Text>{data.content}</Text>\n            </View>\n          )\n        }\n      </View>\n    )\n  }\n}\n","// extracted by mini-css-extract-plugin","import React, { Component } from 'react'\nimport Taro from '@tarojs/taro';\nimport { View } from '@tarojs/components';\nimport { AtAvatar } from 'taro-ui';\n\nimport { Notice } from '../../common/api';\n\nimport './notice-reply.scss'\n\nexport default class NoticeReply extends Component {\n\n  state = {\n    is_read: false,\n  }\n\n  componentDidMount() {\n    this.init();\n  }\n\n  init() {\n    const { data } = this.props;\n    this.setState({\n      is_read: data.is_read,\n    });\n  }\n\n  handleClick = async () => {\n    const { is_read } = this.state;\n    const { data } = this.props;\n    if (!is_read) {\n      const res = await Notice.beComment(null, data.id);\n      if (res) {\n        this.setState({\n          is_read: true,\n        });\n      }\n    }\n\n    Taro.navigateTo({\n      url: '/pages/subPackage/comment/comment?id='+data.comment_id\n    });\n  }\n\n  goUserHome = () => {\n    const { data } = this.props;\n    Taro.navigateTo({\n      url: '/pages/user-home/user-home?id='+data.from_uid\n    })\n  }\n\n  render() {\n    const { is_read } = this.state;\n    const { data } = this.props;\n    return (\n      <View>\n        {\n          data && (\n            <View\n              className='card'\n              style={{\n                backgroundColor: is_read ? '#e5e5e5' : '#ff494933'\n              }}\n              onClick={this.handleClick}\n            >\n              <View className='header' onClick={this.goUserHome}>\n                <AtAvatar image={data.from_user.avatar} size='small' />\n                <View className='right'>\n                  <View className='nickname'>{data.from_user.user_nickname}</View>\n                  <View className='date'>{data.create_at}</View>\n                </View>\n              </View>\n              <View className='content'>{data.content}</View>\n            </View>\n          )\n        }\n      </View>\n    )\n  }\n}\n","// extracted by mini-css-extract-plugin","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../../node_modules/@tarojs/mini-runner/node_modules/babel-loader/lib/index.js!./notice-list.jsx\"\nvar config = {\"navigationBarTitleText\":\"\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/subPackage/notice-list/notice-list', {}, config || {}))\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AACA;AAYA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAFA;AACA;AAGA;AARA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAWA;AACA;AACA;AADA;AAZA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAiBA;AACA;AACA;AADA;AAlBA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAuBA;AACA;AACA;AADA;AAxBA;AACA;AADA;AAAA;AAAA;AACA;AADA;AA6BA;AACA;AACA;AADA;AA9BA;AACA;AADA;AAmCA;AACA;AACA;AACA;AACA;AAHA;AADA;AAOA;AACA;AADA;AAGA;AACA;AA9CA;AAAA;AAAA;AAAA;AAAA;AAAA;;;AAgDA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AADA;AAIA;AAAA;AACA;AADA;AAAA;AACA;AAEA;AAPA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAUA;AAVA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAaA;AAbA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAgBA;AAhBA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAmBA;AAnBA;AACA;AADA;AAsBA;AACA;AACA;AACA;AAFA;AADA;AAMA;AACA;AADA;AAGA;AACA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AAjCA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;AApDA;AACA;AACA;;;AAuFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AACA;AAAA;AAAA;AAVA;AAcA;AACA;AAAA;AAAA;AAfA;AAmBA;AACA;AAAA;AAAA;AApBA;AAwBA;AACA;AAAA;AAAA;AA1BA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","sourceRoot":""}